<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>组件 | NuomiJS</title>
    <meta name="description" content="React + Redux + Router最佳实践">
    <link rel="icon" href="/images/logo.png">
  <link rel="stylesheet" href="/styles/page.css">
    
    <link rel="preload" href="/assets/css/0.styles.61144e05.css" as="style"><link rel="preload" href="/assets/js/app.29414a18.js" as="script"><link rel="preload" href="/assets/js/2.e86ea714.js" as="script"><link rel="preload" href="/assets/js/6.ec184412.js" as="script"><link rel="prefetch" href="/assets/js/10.35678af6.js"><link rel="prefetch" href="/assets/js/11.4501403d.js"><link rel="prefetch" href="/assets/js/12.c5d7d73a.js"><link rel="prefetch" href="/assets/js/3.637a2434.js"><link rel="prefetch" href="/assets/js/4.570df549.js"><link rel="prefetch" href="/assets/js/5.9d386738.js"><link rel="prefetch" href="/assets/js/7.46dd1ba0.js"><link rel="prefetch" href="/assets/js/8.08d6e524.js"><link rel="prefetch" href="/assets/js/9.7920cf89.js">
    <link rel="stylesheet" href="/assets/css/0.styles.61144e05.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NuomiJS</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="https://github.com/nuomijs/nuomi/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更新日志
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/nuomijs/nuomi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="https://github.com/nuomijs/nuomi/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更新日志
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/nuomijs/nuomi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/api/" class="active sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#组件" class="sidebar-link">组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#nuomi" class="sidebar-link">Nuomi</a></li><li class="sidebar-sub-header"><a href="/api/#ruoter" class="sidebar-link">Ruoter</a></li><li class="sidebar-sub-header"><a href="/api/#staticruoter" class="sidebar-link">StaticRuoter</a></li><li class="sidebar-sub-header"><a href="/api/#nuomiroute" class="sidebar-link">NuomiRoute</a></li><li class="sidebar-sub-header"><a href="/api/#shaperoute" class="sidebar-link">ShapeRoute</a></li><li class="sidebar-sub-header"><a href="/api/#route" class="sidebar-link">Route</a></li><li class="sidebar-sub-header"><a href="/api/#redirect" class="sidebar-link">Redirect</a></li><li class="sidebar-sub-header"><a href="/api/#link" class="sidebar-link">Link</a></li><li class="sidebar-sub-header"><a href="/api/#navlink" class="sidebar-link">NavLink</a></li><li class="sidebar-sub-header"><a href="/api/#connect" class="sidebar-link">connect</a></li><li class="sidebar-sub-header"><a href="/api/#withnuomi" class="sidebar-link">withNuomi</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/#hooks" class="sidebar-link">Hooks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#useconnect" class="sidebar-link">useConnect</a></li><li class="sidebar-sub-header"><a href="/api/#usenuomi" class="sidebar-link">useNuomi</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/#对象" class="sidebar-link">对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#router" class="sidebar-link">router</a></li><li class="sidebar-sub-header"><a href="/api/#nuomi-2" class="sidebar-link">nuomi</a></li><li class="sidebar-sub-header"><a href="/api/#store" class="sidebar-link">store</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/#属性" class="sidebar-link">属性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#initialise-state" class="sidebar-link">INITIALISE_STATE</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="组件"><a href="#组件" aria-hidden="true" class="header-anchor">#</a> 组件</h2> <h3 id="nuomi"><a href="#nuomi" aria-hidden="true" class="header-anchor">#</a> Nuomi</h3> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>id</td> <td>''</td> <td>store id，不设置会动态创建</td></tr> <tr><td>async</td> <td>function</td> <td>异步加载props</td></tr> <tr><td>state</td> <td>{}</td> <td>初始状态</td></tr> <tr><td>data</td> <td>{}</td> <td>临时数据</td></tr> <tr><td>store</td> <td>{ dispatch, getState }</td> <td>派发和获取当前模块状态，内部创建，不可修改，也无需传递，dispatch可以调用effects中的方法，也可以调用其他模块的effects</td></tr> <tr><td>reducers</td> <td>{ _updateState }</td> <td>更新状态</td></tr> <tr><td>effects</td> <td>{}</td> <td>异步或者同步更新状态，异步处理使用async await，用于业务处理，支持对象和函数，函数必须返回对象，内部需dispatch调用reducers中的方法，方法名有$前缀时会被设置为loading状态，通过connect可以在loadings中获取到，不需要开发时手动控制loading状态</td></tr> <tr><td>render</td> <td>function</td> <td>渲染组件</td></tr> <tr><td>onInit</td> <td>function</td> <td>状态被创建后回调，可以通过this.store更新状态</td></tr></tbody></table> <h3 id="ruoter"><a href="#ruoter" aria-hidden="true" class="header-anchor">#</a> Ruoter</h3> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>hashPrefix</td> <td>''</td> <td>hash前缀 (<span style="color:red;">0.7.0-</span>)</td></tr> <tr><td>type</td> <td>'hash' or 'browser'</td> <td>路由类型，默认是hash (<span style="color:green;">0.7.0+</span>)</td></tr> <tr><td>basename</td> <td>'/'</td> <td>通用路径 (<span style="color:green;">0.7.0+</span>)</td></tr></tbody></table> <h3 id="staticruoter"><a href="#staticruoter" aria-hidden="true" class="header-anchor">#</a> StaticRuoter</h3> <p>用于服务器渲染 (<span style="color:green;">0.7.0+</span>)</p> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>location</td> <td>'/'</td> <td>服务器端获取的url，可以传入对象，包含pathname、search、params</td></tr> <tr><td>basename</td> <td>'/'</td> <td>通用路径</td></tr> <tr><td>context</td> <td>{}</td> <td>可以通过context.url获取Redirect组件第一次重定向的url</td></tr></tbody></table> <h3 id="nuomiroute"><a href="#nuomiroute" aria-hidden="true" class="header-anchor">#</a> NuomiRoute</h3> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>pathPrefix</td> <td>''</td> <td>路由path前缀，支持字符串和正则</td></tr> <tr><td>path</td> <td>''</td> <td>匹配path，优先级高于pathPrefix (<span style="color:green;">0.8.0+</span>)</td></tr></tbody></table> <h3 id="shaperoute"><a href="#shaperoute" aria-hidden="true" class="header-anchor">#</a> ShapeRoute</h3> <p>可视化设置路由 (<span style="color:green;">0.8.0+</span>)</p> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>routes</td> <td>array</td> <td>由Route/NuomiRoute/Redirect props组成的数组集合，子路由设置在children属性上，支持组件和数组</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 子路由path不用把祖先path加上</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
  path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  children<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      path<span class="token punctuation">:</span> <span class="token string">'/list'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>Router type<span class="token operator">=</span><span class="token string">&quot;hash&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>ShapeRoute routes<span class="token operator">=</span><span class="token punctuation">{</span>routes<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
</code></pre></div><p>其他参数同Nuomi组件</p> <h3 id="route"><a href="#route" aria-hidden="true" class="header-anchor">#</a> Route</h3> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>path</td> <td>''</td> <td>路由path，支持动态参数</td></tr> <tr><td>location</td> <td>{}</td> <td>当前匹配的路由数据，内部创建，不可修改，也无需传递</td></tr> <tr><td>wrapper</td> <td>false</td> <td>是否给留有创建一个div容器，可实现缓存功能  (<span style="color:red;">0.8.0-</span>)</td></tr> <tr><td>cache</td> <td>false</td> <td>是否给留有创建一个div容器，可实现缓存功能  (<span style="color:green;">0.8.0+</span>)</td></tr> <tr><td>reload</td> <td>false</td> <td>匹配路由后是否重置状态，值为null则不法刷新</td></tr> <tr><td>onEnter</td> <td>function</td> <td>路由匹配后，在reducer被创建之前回调，返回false将无法展示内容，参数为强制展示回调，调用后可以展示内容</td></tr> <tr><td>onChange</td> <td>function</td> <td>路由匹配时回调，支持函数和对象</td></tr> <tr><td>onLeave</td> <td>function</td> <td>路由离开时回调，用于决定是否可以离开</td></tr></tbody></table> <p>其他参数同Nuomi组件，
回调的执行顺序是 onEnter &gt; location.data &gt; onChange &gt; onInit，location.data下面路由跳转时会讲到
<br><b>注意：path和cache不能异步加载</b></p> <h3 id="redirect"><a href="#redirect" aria-hidden="true" class="header-anchor">#</a> Redirect</h3> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>from</td> <td>''</td> <td>匹配当前路由path，会重定向至to设置的path</td></tr> <tr><td>to</td> <td>''</td> <td>重定向路由path</td></tr> <tr><td>reload</td> <td>false</td> <td>跳转后是否重置状态</td></tr></tbody></table> <h3 id="link"><a href="#link" aria-hidden="true" class="header-anchor">#</a> Link</h3> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>to</td> <td>''</td> <td>目标path</td></tr> <tr><td>data</td> <td>{}</td> <td>传递的数据 (<span style="color:green;">0.8.0+</span>)</td></tr> <tr><td>replace</td> <td>false</td> <td>跳转是否替换当前history (<span style="color:green;">0.8.0+</span>)</td></tr> <tr><td>reload</td> <td>false</td> <td>跳转后是否重置状态</td></tr></tbody></table> <h3 id="navlink"><a href="#navlink" aria-hidden="true" class="header-anchor">#</a> NavLink</h3> <p>可以匹配path的Link (<span style="color:green;">0.8.0+</span>)</p> <table><thead><tr><th>props</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>path</td> <td>''</td> <td>匹配path</td></tr> <tr><td>activeClassName</td> <td>''</td> <td>匹配className</td></tr> <tr><td>activeStyle</td> <td>null</td> <td>匹配样式</td></tr> <tr><td>isActice</td> <td>function</td> <td>自定义匹配，返回boolean，第一个参数是匹配结果，第二个参数是当前location对象</td></tr></tbody></table> <p>其他参数参考Link</p> <h3 id="connect"><a href="#connect" aria-hidden="true" class="header-anchor">#</a> connect</h3> <p>用法同react-redux connect，区别是获取状态的函数，第一个参数是获取当前模块的状态，第二个参数是获取全部store里的状态</p> <h3 id="withnuomi"><a href="#withnuomi" aria-hidden="true" class="header-anchor">#</a> withNuomi</h3> <p>使用后组件中提供nuomiProps属性，nuomiProps指向Nuomi/NuomiRoute/Route组件的props</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">List</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> nuomiProps <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something</span>
<span class="token punctuation">}</span>

<span class="token function">withNuomi</span><span class="token punctuation">(</span>List<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="hooks"><a href="#hooks" aria-hidden="true" class="header-anchor">#</a> Hooks</h2> <h3 id="useconnect"><a href="#useconnect" aria-hidden="true" class="header-anchor">#</a> useConnect</h3> <p>高阶组件connect的替代方法</p> <p>方法返回一个数组，第一个值是状态，第二个值为dispatch，不传参数默认返回当前模块所有状态，接收一个回调函数参数时，用法等同connect第一个参数</p> <h3 id="usenuomi"><a href="#usenuomi" aria-hidden="true" class="header-anchor">#</a> useNuomi</h3> <p>高阶组件withNuomi的替代方法</p> <p>方法返回一个对象，包含nuomiProps属性</p> <h2 id="对象"><a href="#对象" aria-hidden="true" class="header-anchor">#</a> 对象</h2> <h3 id="router"><a href="#router" aria-hidden="true" class="header-anchor">#</a> router</h3> <h4 id="router-location"><a href="#router-location" aria-hidden="true" class="header-anchor">#</a> router.location</h4> <p>路由跳转</p> <table><thead><tr><th>参数</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>path</td> <td>''</td> <td>跳转的路由地址</td></tr> <tr><td>data</td> <td>{}</td> <td>值为对象时表示跳转后传递的临时数据，切换路由后该数据将不存在，跳转后的路由模块中可以通过data获取，data对象上面Nuomi组件有提到，当值是函数时，函数的参数可以获取跳转后路由的props，可以通过store更新状态，更新状态发生在onChange之前，当值为布尔时，等同reload</td></tr> <tr><td>reload</td> <td>false</td> <td>跳转后是否重置状态</td></tr> <tr><td>force</td> <td>true</td> <td>当path是当前路由path时，是否强制跳转，reload为true时该值自动为true</td></tr></tbody></table> <p>不传参数表示获取当前路由数据</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">location</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取当前路由数据</span>
router<span class="token punctuation">.</span><span class="token function">location</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 跳转后刷新</span>
router<span class="token punctuation">.</span><span class="token function">location</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 跳转后传递临时参数并刷新</span>
router<span class="token punctuation">.</span><span class="token function">location</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 跳转后更新状态</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        type<span class="token punctuation">,</span>
        payload
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// path支持对象，字段等同router.location()获取的对象字段</span>
router<span class="token punctuation">.</span><span class="token function">location</span><span class="token punctuation">(</span><span class="token punctuation">{</span> pathname<span class="token punctuation">:</span> <span class="token string">'/path'</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span> <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// /path?a=1</span>
</code></pre></div><h4 id="router-replace"><a href="#router-replace" aria-hidden="true" class="header-anchor">#</a> router.replace</h4> <p>路由跳转，在history中替换当前地址，参数等同location (<span style="color:green;">0.7.0+</span>)</p> <h4 id="router-listener"><a href="#router-listener" aria-hidden="true" class="header-anchor">#</a> router.listener</h4> <p>监听路由变化</p> <table><thead><tr><th>参数</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>callback</td> <td>function</td> <td>接受参数为location，可以获取当前匹配的路由数据</td></tr></tbody></table> <p>返回取消监听方法</p> <h4 id="router-reload"><a href="#router-reload" aria-hidden="true" class="header-anchor">#</a> router.reload</h4> <p>路由刷新，等同router.location(当前path, true)</p> <h4 id="router-back"><a href="#router-back" aria-hidden="true" class="header-anchor">#</a> router.back</h4> <p>后退</p> <h4 id="router-forward"><a href="#router-forward" aria-hidden="true" class="header-anchor">#</a> router.forward</h4> <p>前进</p> <h4 id="router-matchpath"><a href="#router-matchpath" aria-hidden="true" class="header-anchor">#</a> router.matchPath</h4> <p>用于匹配路由</p> <table><thead><tr><th>参数</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>location</td> <td>{}</td> <td>路由location对象</td></tr> <tr><td>path</td> <td>''</td> <td>路由设置的path</td></tr></tbody></table> <h4 id="router-mergepath"><a href="#router-mergepath" aria-hidden="true" class="header-anchor">#</a> router.mergePath</h4> <p>合并path (<span style="color:green;">0.8.0+</span>)</p> <table><thead><tr><th>参数</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>path1, path2, ...</td> <td>string</td> <td>路由path</td></tr></tbody></table> <h4 id="router-block"><a href="#router-block" aria-hidden="true" class="header-anchor">#</a> router.block</h4> <p>定义阻塞路由，接收一个回调函数作为参数，回调函数包含下面参数，返回false则不能跳转 (<span style="color:green;">0.8.0+</span>)</p> <table><thead><tr><th>参数</th> <th>value</th> <th>介绍</th></tr></thead> <tbody><tr><td>from</td> <td>{}</td> <td>当前location</td></tr> <tr><td>to</td> <td>{}</td> <td>目标location</td></tr> <tr><td>enter</td> <td>function</td> <td>确认跳转函数，在异步中使用</td></tr></tbody></table> <h3 id="nuomi-2"><a href="#nuomi-2" aria-hidden="true" class="header-anchor">#</a> nuomi</h3> <h4 id="nuomi-getdefaultprops"><a href="#nuomi-getdefaultprops" aria-hidden="true" class="header-anchor">#</a> nuomi.getDefaultProps</h4> <p>获取最新的默认props</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 默认props</span>
<span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    loadings<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  reducers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">_replaceState</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> payload<span class="token punctuation">,</span>
    <span class="token function-variable function">_updateState</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">_updateLoading</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>state<span class="token punctuation">,</span>
      loadings<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">.</span>loadings<span class="token punctuation">,</span> <span class="token operator">...</span>payload <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="nuomi-config"><a href="#nuomi-config" aria-hidden="true" class="header-anchor">#</a> nuomi.config</h4> <p>设置默认props，设置后会覆盖默认值</p> <div class="language-js extra-class"><pre class="language-js"><code>nuomi<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        dataSource<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    reducers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">updateState</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="nuomi-extend"><a href="#nuomi-extend" aria-hidden="true" class="header-anchor">#</a> nuomi.extend</h4> <p>合并props，state、reducers、data等会被浅合并</p> <h3 id="store"><a href="#store" aria-hidden="true" class="header-anchor">#</a> store</h3> <p>请参考 <a href="https://cn.redux.js.org/docs/basics/Store.html" target="_blank" rel="noopener noreferrer">redux store<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
原生方法建议只使用getState和dispatch，除此之外额外新增了getStore和applyMiddleware方法</p> <h4 id="store-getstate"><a href="#store-getstate" aria-hidden="true" class="header-anchor">#</a> store.getState</h4> <p>获取所有状态</p> <h4 id="store-dispatch"><a href="#store-dispatch" aria-hidden="true" class="header-anchor">#</a> store.dispatch</h4> <p>更新状态，只能触发reducers中的方法，如果想调用effects方法，请使用store.getStore替代</p> <h4 id="store-getstore"><a href="#store-getstore" aria-hidden="true" class="header-anchor">#</a> store.getStore</h4> <p>获取nuomi组件的store，参数是store id，返回对象包含getState和dispatch</p> <h4 id="store-applymiddleware"><a href="#store-applymiddleware" aria-hidden="true" class="header-anchor">#</a> store.applyMiddleware</h4> <p>添加中间件</p> <div class="language-js extra-class"><pre class="language-js"><code>store<span class="token punctuation">.</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">,</span> logger<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="store-createstate"><a href="#store-createstate" aria-hidden="true" class="header-anchor">#</a> store.createState</h4> <p>初始化状态，只能对 <code>nuomiPorps</code> 中设置了 <code>id</code> 属性的模块初始化 (<span style="color:green;">0.7.0+</span>)</p> <h2 id="属性"><a href="#属性" aria-hidden="true" class="header-anchor">#</a> 属性</h2> <h3 id="initialise-state"><a href="#initialise-state" aria-hidden="true" class="header-anchor">#</a> INITIALISE_STATE</h3> <p>服务端渲染时用于给window对象添加初始化状态属性 (<span style="color:green;">0.7.0+</span>)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'http'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> renderToString <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dom/server'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">INITIALISE_STATE</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'nuomi'</span><span class="token punctuation">;</span>

<span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">renderToString</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span> global<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span><span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;html&gt;
      &lt;body&gt;
        &lt;div id=&quot;root&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>html<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;
        &lt;script&gt;window.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">INITIALISE_STATE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/script&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.29414a18.js" defer></script><script src="/assets/js/2.e86ea714.js" defer></script><script src="/assets/js/6.ec184412.js" defer></script>
  </body>
</html>
